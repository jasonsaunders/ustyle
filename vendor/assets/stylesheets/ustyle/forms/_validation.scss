// @page Code/Forms
// @name Form validation
//
// @description
//   Validation message and input styling provides a consistent look and feel to uStyle forms.
//
// @state .us-validation--bordered - use this for any singular field validation or validation on backgrounds
// @state .us-validation--success - Success styling for correct forms
// @state .us-validation--error - Error styling (default) for incorrect data on forms
//
// @markup
//   <div class="us-validation__input {$modifiers}">
//     <input type="email" class="us-form-input" name="email" />
//   </div>
//   
//   <div class="us-validation {$modifiers}">
//     <div class="us-validation__icon"></div>
//     <div class="us-validation__message">Validation message here</div>
//   </div>

$message-padding-vertical: .35em;
$message-padding-horizontal: .5em;
$message-padding-horizontal--bordered: 1em;
$message-min-height: 2.4em;
$message-triangle-size: 10px;

$icon-bg-size: 26px;
$icon-input-bg-size: 14px;
$icon-text-color: #fff;

$error-color: $c-red;
$error-icon: "!";

$success-color: $c-green;
$success-icon: "\2713";

@mixin validation-style($color: $error-color, $icon: $error-icon) {
  .us-validation__message {
    color: $color;
    border-color: $color;

    &:before,
    &:after {
      border-color: $color;
    }

    &:after {
      border-right-color: #fff;
    }
  }
  
  .us-validation__icon {
    background-color: $color;

    &:before {
      content: $icon;
    }
  }
}

@mixin validation-input-style($color, $icon) {
  .us-form-input,
  .us-form-input:hover {
    border-color: $color;
  }

  &:after {
    background-color: $color;
    content: $icon;
  }
}

%validation-icon {
  @include heading-font-secondary;
  position: absolute;
  color: $icon-text-color;
  text-align: center;
  border-radius: 50%;
}

.us-validation {
  position: relative;
  display: block;
  padding: .25em 0 .25em $icon-bg-size + 5;

  &,
  &.us-validation--error,
  &.us-validation--bordered {
    @include validation-style;
  }

  &.us-validation--success {
    @include validation-style($success-color, $success-icon);
  }
}

.us-validation__message {
  position: relative;
  display: block;
  min-height: $message-min-height;
  padding: $message-padding-vertical $message-padding-horizontal;
  margin: 0;
  line-height: 1.5;

  .us-validation--bordered & {
    padding: $message-padding-vertical $message-padding-horizontal--bordered;
    margin: 0 0 0 $message-triangle-size;
    background-color: #fff;
    border-style: solid;
    border-width: 1px;
    border-radius: 3px;

    &:before,
    &:after {
      position: absolute;
      top: 8px;
      left: -$message-triangle-size;
      border-top-color: transparent !important;
      border-bottom-color: transparent !important;
      border-style: solid;
      border-width: $message-triangle-size;
      border-left-width: 0;
      content: " ";
    }

    &:after {
      left: -$message-triangle-size + 1;
    }
  }
}

.us-validation__icon {
  @extend %validation-icon;
  top: 10px;
  left: 0;
  width: $icon-bg-size;
  height: $icon-bg-size;
  font-size: ceil($icon-bg-size * .8);
  line-height: $icon-bg-size;
}

.us-validation__input {
  position: relative;
  display: inline-block;

  &:after {
    @extend %validation-icon;
    top: -$icon-input-bg-size / 2;
    right: -$icon-input-bg-size / 2;
    width: $icon-input-bg-size;
    height: $icon-input-bg-size;
    font-size: ceil($icon-input-bg-size * .8);
    line-height: $icon-input-bg-size;
  }

  &,
  &.us-validation--error {
    @include validation-input-style($error-color, $error-icon);
  }
  
  &.us-validation--success {
    @include validation-input-style($success-color, $success-icon);
  }
}
