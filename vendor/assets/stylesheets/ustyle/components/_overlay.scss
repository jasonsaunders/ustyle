// @page Code/Components
// @name Overlay
//
// @description
//  `.us-overlay` can slide from either side and turn into a modal if `.us-overlay-modal-parent` is added to a parent.
//  
//  To initialise call `var overlay = new Overlay({options})`
// 
// @state .us-overlay--right - Slide from the right
// @state .us-overlay--sticky-header - Sticky header
//
// @markup
//   <button class='us-btn js-open-overlay' modifier="{$modifiers}">Open</button>
// 
//   <div class="us-overlay-parent us-overlay-modal-parent" modifier="{$modifiers}">
//     <div class="us-overlay {$modifiers}">
//       <div class="us-overlay__header">
//         <div class="us-overlay__title">
//           Overlay
//         </div>
//         <button class="us-overlay__close js-close-overlay"></button>
//       </div>
//       <div class="us-overlay__container">
//         Bacon ipsum dolor amet exercitation ground round voluptate, fatback qui cupidatat sunt consectetur. Dolore strip steak pancetta ground round, venison rump tenderloin fatback frankfurter prosciutto deserunt do ex. In cupim ullamco bresaola, beef meatball aliqua laborum landjaeger consectetur tail cupidatat pariatur meatloaf ball tip. Anim cupim dolore, filet mignon kielbasa tri-tip short ribs esse porchetta landjaeger qui pork loin.
//         Ground round nostrud pastrami tempor cow short loin. Ut short ribs alcatra laboris brisket leberkas cow ham hock pork loin excepteur porchetta labore meatloaf. Labore filet mignon ball tip eu pork chop tri-tip porchetta alcatra. Ut consequat cupim ad corned beef sunt proident strip steak tongue irure pastrami kielbasa t-bone.
//         Cow in tenderloin minim, aliqua in turkey anim filet mignon adipisicing reprehenderit bacon. Kielbasa turducken sunt dolore, velit alcatra filet mignon sint commodo beef ribs consectetur pork belly frankfurter pork chop meatloaf. Veniam in ad pork belly deserunt. Kevin sed cupidatat magna, swine incididunt reprehenderit tongue short loin pig kielbasa ham hock frankfurter salami beef ribs. Est corned beef shoulder ipsum, pancetta pork shankle meatloaf in beef in drumstick fatback velit pork chop. Meatloaf velit brisket mollit, ut kielbasa t-bone ex landjaeger pork chop adipisicing prosciutto shankle. Brisket turkey ham hock beef ribs, voluptate venison swine flank doner capicola rump tempor.
//         Reprehenderit proident turkey mollit ut ipsum magna chuck ut brisket venison do. Exercitation boudin cillum prosciutto. Incididunt excepteur sint pork labore pork loin tri-tip salami cow elit bresaola beef ribs aliquip duis. Dolore nisi frankfurter ut magna.
//         Et anim ad commodo, pork aliquip occaecat. Frankfurter kielbasa dolore, landjaeger chuck pork in drumstick fatback. Nulla minim dolor, ut filet mignon ground round id esse beef strip steak do laboris. Kielbasa hamburger consectetur, picanha fatback incididunt aute turducken pig in rump landjaeger qui pork tongue. Sausage cupim consectetur, drumstick et ea fatback consequat leberkas alcatra meatloaf. Duis rump velit est cupidatat in.
//       </div>
//     </div>
//     <div class="us-overlay__back-layer js-close-overlay"></div>
//   </div>

$overlay-modal-breakpoint: desktop !default;
$overlay-modal-width: 60% !default;
$overlay-modal-height: 80% !default;
$overlay-max-modal-width: 700px !default;
$overlay-forced-z-index: 1003 !default;
$overlay-transition-speed: .4s !default;
$overlay-mobile-width: calc(100% - 25px) !default;
$overlay-tablet-width: 340px !default;
$overlay-header-height: 55px !default;
$overlay-close-icon-size: 35px !default;
$overlay-z-index: $overlay-forced-z-index;

@mixin overlay($place-above: false) {
  position: fixed;
  top: 0;
  left: 0;
  z-index: $overlay-forced-z-index;
  width: $overlay-mobile-width;
  height: 100%;
  background: #fff;
  overflow: auto;
  transition: transform $overlay-transition-speed;
  transition-timing-function: cubic-bezier(.175, .885, .335, 1.05);
  transform: translateX(-100%);
  transform: translate3d(-100%, 0, 0);
  -webkit-overflow-scrolling: auto;

  .no-csstransforms & {
    display: none;
  }

  .us-overlay--open & {
    transform: translateX(0);
    transform: translate3d(0, 0, 0);

    .no-csstransforms & {
      display: block;
    }
  }

  @include respond-to(small-tablet, true) {
    width: $overlay-tablet-width;
  }

  .us-overlay-modal-parent & {
    @include respond-to($overlay-modal-breakpoint, true) {
      position: relative;
      width: $overlay-modal-width;
      max-width: $overlay-max-modal-width;
      max-height: $overlay-modal-height;
      margin: 5% auto;
    }
  }

  @if $place-above {
    $overlay-z-index: $overlay-z-index + 1;
  }

  z-index: $overlay-z-index;
}

.us-overlay {
  @include overlay;

  .us-overlay-modal-parent & {
    @include respond-to($overlay-modal-breakpoint, true) {
      overflow: hidden;
    }
  }
}

.us-overlay--sticky-header {
  overflow: hidden;
}

.us-overlay__container {
  @extend %container !optional;
  padding: 1em;

  .us-overlay-modal-parent & {
    @include respond-to($overlay-modal-breakpoint, true) {
      height: 100%;
      padding-bottom: $overlay-header-height + 16px;
      overflow: scroll;
    }
  }

  .us-overlay--sticky-header & {
    height: 100%;
    padding-bottom: $overlay-header-height + 16px;
    overflow: scroll;
  }
}

.us-overlay-modal-parent {
  @include respond-to($overlay-modal-breakpoint, true) {
    position: fixed;
    top: 0;
    left: 0;
    z-index: $overlay-forced-z-index + 1;
    display: none;
    width: 100%;
    height: 100%;

    &.us-overlay--open {
      display: block;
    }
  }
}

.us-overlay--right {
  right: 0;
  left: auto;
  transform: translateX(100%);
  transform: translate3d(100%, 0, 0);
  transform: translate3d(100%, 0, 0);

  .us-overlay--open & {
    transform: translateX(0);
    transform: translate3d(0, 0, 0);

    .no-csstransforms & {
      display: block;
    }
  }
}

.us-overlay__header {
  position: relative;
  min-height: $overlay-header-height;
  padding: 1em;
  color: #fff;
  background: $c-navy;
}

.us-overlay__title {
  width: calc(100% - #{$overlay-close-icon-size});
}

.us-overlay__close {
  position: absolute;
  top: 50%;
  right: .5em;
  z-index: 10;
  width: $overlay-close-icon-size;
  height: $overlay-close-icon-size;
  margin-top: - $overlay-close-icon-size / 2;
  color: $c-navy;
  cursor: pointer;
  background-color: #fff;
  border: 0;
  border-radius: 50%;
  -webkit-appearance: none;

  &:before {
    font-size: $overlay-close-icon-size + 5px;
    font-weight: bold;
    line-height: 31px;
    content: "\00d7";
  }
}

.us-overlay__back-layer {
  position: fixed;
  top: 0;
  left: 0;
  z-index: $overlay-forced-z-index - 1;
  display: none;
  width: 100%;
  height: 150%;
  background: rgba($c-blue, .5);

  .us-overlay--open & {
    display: block;
  }
}

.us-overlay__back-layer--open {
  display: block;
}
